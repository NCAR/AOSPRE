<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://example.com/testcase/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Run the test case - APAR Observing Simulation, Processing, and Research Environment (AOSPRE) Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Run the test case";
        var mkdocs_page_input_path = "testcase.md";
        var mkdocs_page_url = "/testcase/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> APAR Observing Simulation, Processing, and Research Environment (AOSPRE) Documentation
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../preliminaries/">Preliminaries and Prerequsites</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../building/">Build the AOSPRE executable from source</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../acquiretables/">Acquire the CR-SIM tables</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Run the test case</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#wrf-formatted-model-output-files">WRF-formatted model output files</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#scanning-tables">Scanning tables</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#cr-sim-configuration-table">CR-SIM configuration table</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#aospre-namelist-files">AOSPRE namelist files</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#wrf_glob_pattern">wrf_glob_pattern</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#output_filename_format_string">output_filename_format_string</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#leg_initial_time">leg_initial_time</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#leg_time_seconds">leg_time_seconds</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#flight_waypoints_x-y-and-z">flight_waypoints_x, y, and z</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#crsim_config">CRSIM_Config</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#scanning_table">scanning_table</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#run-the-aospre-program">Run the AOSPRE program</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#modify-the-flightpath-to-run-again">Modify the flightpath to run again</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#further-exploration">Further exploration</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../running/">Running your own case</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../namelist/">Namelist</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../scanning_table_library/">Scanning table library</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../references/">References</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">APAR Observing Simulation, Processing, and Research Environment (AOSPRE) Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Run the test case</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="test-case-mini-tutorial">Test case mini-tutorial</h1>
<p>A small case has been set up for a quick and simple test run. Input files,
configuration files, and namelists have all been set up for this test
case.</p>
<p>From the top-level <code><nobr>AOSPRE</nobr></code>
directory, move to the working directory for the test case:</p>
<blockquote>
<p><code>cd test</code></p>
</blockquote>
<p>This directory will be your working directory for running the test case.</p>
<p>Several components are required for a successful run of AOSPRE.  All of
these components have been prepared in a simple configuration for this
test case.  Do a listing of the current working directory:</p>
<blockquote>
<p><code>ls -l</code></p>
</blockquote>
<p>The various files required for a run of AOSPRE are described below.</p>
<h2 id="wrf-formatted-model-output-files">WRF-formatted model output files</h2>
<p>The principal data from which simulated radar sweep will be
constructed are contained in model output files from a high-resolution
weather model.  In this example, the CM1 model running with 500-m grid
spacing simulated an idealized supercell.  For this example, three
vertical slices from the full model run have been extracted at two
output times.  This is enough for a couple of RHI sweeps as a
demonstration.  These data are found in the "wrfout" files in this directory:</p>
<blockquote>
<p><code>wrfout_test_4650.nc<br></code>
<code>wrfout_test_4660.nc</code></p>
</blockquote>
<p>The <code>4650</code> and <code>4660</code> numerals in these sample
filenames indicate the number of seconds since model initialization.
You can use the NetCDF utility program <code>ncdump</code> to examine
the contents of these model output files, and the <code>ncview</code>
graphics utility program (if available) to get a quick look at the
meteorological fields in these files.</p>
<h2 id="scanning-tables">Scanning tables</h2>
<p>AOSPRE relies on user-provided scanning tables to define the beams and
sweeps that will be used to sample the atmospheric state as
represented in the model output files.  For this example, these files are:</p>
<blockquote>
<p><code>scanning_bot.txt</code><br>
<code>scanning_lhs.txt</code><br>
<code>scanning_rhs.txt</code><br>
<code>scanning_top.txt</code></p>
</blockquote>
<p>where "bot", "lhs", "rhs", and "top" indicate the bottom panel of the
APAR platform, the left-hand (port) side panel, the right-hand
(starboard) side panel, and the top panel.</p>
<p>The bulk of these scanning table files is a series of beam directions,
expressed in terms of rotation and tilt angles in the "type-Z"
coordinate system (<i>cf.</i> CfRadial documentation), These particular files
have been set up for this test case to produce sweeps in the plane
perpendicular to the direction of flight.</p>
<h2 id="cr-sim-configuration-table">CR-SIM configuration table</h2>
<p>The components of CR-SIM used by AOSPRE use a configuration file to
specify characteristics of the simulated radar.  This configuration file is:</p>
<blockquote>
<p><code>CONFIG_crsim</code></p>
</blockquote>
<p>Details of the CR-SIM configuration may be found in the CR-SIM
documentation.  Note that only certain entries in this configuration
setup are used by AOSPRE; the entries related to radar position, lidar,
Micropulse lidar (MPL) and postprocessing are not used by AOSPRE.</p>
<h2 id="aospre-namelist-files">AOSPRE namelist files</h2>
<p>AOSPRE processing is controlled by one or more Fortran namelist files:</p>
<blockquote>
<p><code>namelist.BOT</code><br>
<code>namelist.LHS</code><br>
<code>namelist.RHS</code><br>
<code>namelist.TOP</code></p>
</blockquote>
<p>Where the bottom, left-hand side, right-hand side, and top panels each have their own namelist files.</p>
<p>The namelist files specify the flight path and radar scanning strategy
for a flight, and the input and output files for the AOSPRE processing..
See the <a href="../namelist/">namelist documentation</a> for details of the
namelist entries.  Several of the critical namelist entries are described below:</p>
<h3 id="wrf_glob_pattern">wrf_glob_pattern</h3>
<blockquote>
<p>The <code>wrf_glob_pattern</code> entry defines how AOSPRE finds the
  atmospheric model output files.  Any file matching the glob pattern
  (using standard wildcard matching where '?' matches any single
  character and '*' matches any number of characters) will be
  interpreted as a model output file.  In this example, the
  <code>wrf_glob_pattern</code> has been set up to match the names of
  both WRF output files provided for the test.</p>
</blockquote>
<h3 id="output_filename_format_string">output_filename_format_string</h3>
<blockquote>
<p>The <code>output_filename_format_string</code> determines how the
  CfRadial-formatted files produced by AOSPRE will be named.  This entry
  must specify a Fortran format string with exactly two 'A' format
  specifiers, used to build output file names.  The 'A' format
  specifiers will resolve to the beginning and ending time of the
  sweeps in any particular output file.  With each panel of the APAR
  platform producing its own set of output volumes, the file name
  construction should be unique for each panel.  Compare the
  <code><nobr>output_filename_format_string</nobr></code> for each
  namelist in the test directory.</p>
</blockquote>
<h3 id="leg_initial_time">leg_initial_time</h3>
<blockquote>
<p>The <code>leg_initial_time</code> entry specifies the time (in
  seconds from model initialization) to start a data-collection flight
  leg.  Since the example WRF output files contain only 10 seconds of
  data (model output times at 4650 to 4660 seconds past
  initialization), we've set up the namelists for an 8-second flight
  leg starting at time 4651 seconds past initialization.</p>
</blockquote>
<h3 id="leg_time_seconds">leg_time_seconds</h3>
<blockquote>
<p>The <code>leg_time_seconds</code> entry specifies the duration in
  seconds of the data-collection fligh leg.  As mentioned above, only
  a minimal set of data is provided for this small test.  An 8-second
  flight will fit within the data provided.</p>
</blockquote>
<h3 id="flight_waypoints_x-y-and-z">flight_waypoints_x, y, and z</h3>
<blockquote>
<p>The entries <code><nobr>flight_waypoints_x</nobr></code>,
  <code><nobr>flight_waypoints_y</nobr></code>, and
  <code><nobr>flight_waypoints_z</nobr></code> specify the flight path
  taken through the model output files.  The X and Y coordinates are
  specified in terms of grid-point indices in the model grid (x and y
  both equal 1 at the lower left grid point).  The Z coordinate may be
  specified in meters above MSL, or as pressure in hPa, depending on
  the setting of <code><nobr>flight_level_coordinate</nobr></code>.</p>
<p>The test dataset (in the wrfout files) consists of three vertical
  slices, in the south-north direction, from a larger model grid.  The
  dimensions of this subset grid (X x Y) are 3 x 400.  Our initial
  flight is set up to move from west to east at y=105, south of the
  main body of the storm, at 2000 meters above sea level.</p>
<p>When running AOSPRE with for multiple APAR panels, the namelists for
  each panel must be set up with the same flight path and flight time
  information.</p>
</blockquote>
<h3 id="crsim_config">CRSIM_Config</h3>
<blockquote>
<p>The <code>CRSIM_Config</code> entry must specify the file name of
  the CR-SIM configuration file, in this case, "CONFIG_crsim".</p>
</blockquote>
<h3 id="scanning_table">scanning_table</h3>
<blockquote>
<p>The <scanning_table> entry specifies the name of the file that
  contains the details of the radar beam directions for the panel
  represented by the namelist.  Compare the
  <code><nobr>scanning_table</nobr></code> entries for the four
  namelists provided.</p>
</blockquote>
<h2 id="run-the-aospre-program">Run the AOSPRE program</h2>
<p>The AOSPRE executable takes as command-line arguments the names of one or
more namelist files.  As a first run of AOSPRE, invoke a flight using the
original namelist settings, with only the left-hand side panel
active:</p>
<blockquote>
<p><code>../code/embed_crsim/aospre namelist.LHS</code></p>
</blockquote>
<p>If you get an immediate segmentation fault, you may need to unlimit
the stacksize in your terminal session:</p>
<blockquote>
<p><code>ulimit -s unlimited</code> for bash shell,</p>
<p><code>unlimit stacksize</code> for csh shell,</p>
</blockquote>
<p>and try again.</p>
<p>A successful run will result in several CfRadial-formatted files from
the left-hand side panel of the APAR platform.  E.g.:</p>
<p><code>LHS_rhi_20010101_011731.092_to_20010101_011732.149.nc</code><br>
<code>LHS_rhi_20010101_011732.244_to_20010101_011733.301.nc</code><br>
<code>LHS_rhi_20010101_011733.396_to_20010101_011734.453.nc</code><br>
<code>LHS_rhi_20010101_011734.548_to_20010101_011735.605.nc</code><br>
<code>LHS_rhi_20010101_011735.700_to_20010101_011736.757.nc</code><br>
<code>LHS_rhi_20010101_011736.852_to_20010101_011737.909.nc</code><br></p>
<p>These contents of these files may be examined with the NetCDF utility
program <code>ncdump</code>, and may be explored with the
<code>ncview</code> utility program.  Since these files are in radar
coordinates, it is often difficult to make sense of the quick-look
views provided by the <code>ncview</code> program.  Other graphics
capabilities that work with the radar coordinates, such as those in
the LROSE package, are beyond the scope of this mini-tutorial.</p>
<p>Note also the file <code><nobr>flightpath.ascii</nobr></code>.  This
file preserves details of the aircraft's flight through the
simulation, with locations, directions, and wind values at the
aircraft location, every tenth of a second.</p>
<h2 id="modify-the-flightpath-to-run-again">Modify the flightpath to run again</h2>
<p>To explore the multi-panel capability, edit all the namelists to move
the <code><nobr>flight_waypoints_y</nobr></code> entries to somewhere
near the middle of the supercell, at Y index about 150, where the
various panels may all see interesting weather.</p>
<p>Rerun the flight with the left panel:</p>
<blockquote>
<p><code>../code/embed_crsim/aospre namelist.LHS</code></p>
</blockquote>
<p>And do a repeat flight with the right panel:</p>
<blockquote>
<p><code>../code/embed_crsim/aospre namelist.RHS</code></p>
</blockquote>
<p>Note the additional RHS CfRadial files produced by this second run.</p>
<p>You can also run multiple APAR panels in the same run, by specifying
multiple namelists on as command-line arguments to the AOSPRE executable.</p>
<p>E.g., try:</p>
<blockquote>
<p><code>../code/embed_crsim/aospre namelist.RHS namelist.LHS</code></p>
</blockquote>
<p>or</p>
<blockquote>
<p><code>../code/embed_crsim/aospre namelist.BOT namelist.TOP</code></p>
</blockquote>
<p>or</p>
<blockquote>
<p><code>../code/embed_crsim/aospre namelist.BOT namelist.TOP namelist.LHS namelist.RHS</code></p>
</blockquote>
<p>and note the output generated.</p>
<h2 id="further-exploration">Further exploration</h2>
<p>As noted before, the minimal WRF output dataset allows only limited
AOSPRE runs.  But there are a variety of runs you can do to further
explore the data or familiarize yourself with AOSPRE configuration.  E.g.:</p>
<ul>
<li>Try setting up flights north of the storm.
<li>Try setting up flights from west to east.
<li> See how results change with flights at different levels.
<li> Change the direction of the flight and the corresponding orientation of the beams in the scanning tables and still get sweeps within the slices of the WRF output data.
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../acquiretables/" class="btn btn-neutral float-left" title="Acquire the CR-SIM tables"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../running/" class="btn btn-neutral float-right" title="Running your own case">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../acquiretables/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../running/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
